<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="pull-left">Servers</h4>
                    <button class=" btn btn-success pull-right" ng-click="$ctrl.addServer()">
                       Add new Server
                    </button>
                    <span class="clearfix"></span>
                </div>
                <div class="panel-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead>
                            <th>name</th>
                            <th>port</th>
                            <th>enabled</th>
                            <th>edit</th>
                            <th>conf</th>
                            </thead>
                            <tbody>
                            <tr ng-repeat="server in $ctrl.servers track by $index" ng-class="{'editing' : $ctrl.editServer.$loki === server.$loki}">
                                <td ng-bind="server.displayName"></td>
                                <td ng-bind="server.port"></td>
                                <td class="enable">
                                    <div class="checkbox pull-right">
                                        <label>
                                            <input type="checkbox"
                                                   class="toogle"
                                                   data-toggle="toggle"
                                                   ng-change="$ctrl.save()"
                                                   data-on="Enabled"
                                                   data-off="Disabled"
                                                   ng-disabled="$ctrl.mode === 'edit' && $ctrl.editServer.$loki === server.$loki"
                                                   ng-model="server.enable">
                                        </label>
                                    </div>
                                </td>
                                <td class="edit">
                                <span class="glyphicon glyphicon-edit text-center center-block"
                                      ng-click="$ctrl.edit(server)"
                                      ng-if="$ctrl.editServer.$loki !== server.$loki"
                                      uib-tooltip="Edit server configuration"
                                      tooltip-append-to-body="true"></span>
                                    <span class="glyphicon glyphicon-remove-circle text-center center-block"
                                          ng-click="$ctrl.stopEdit()"
                                          ng-if="$ctrl.editServer.$loki === server.$loki"
                                          uib-tooltip="Cancel server configuration"
                                          tooltip-append-to-body="true"></span>
                                </td>
                                <td class="conf">
                                <span class="glyphicon glyphicon-zoom-in text-center center-block"
                                      ng-click="$ctrl.openConf(server)"
                                      uib-tooltip="Open ninx configuration"
                                      tooltip-append-to-body="true"></span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-6" ng-if="$ctrl.mode==='nominal'">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>Nginx runner</h4>
                </div>
                <div class="panel-body">
                    <button class="form-control btn btn-success" type="button" ng-if="!$ctrl.isRunning"
                            ng-click="$ctrl.runNginx()">Run Nginx
                    </button>
                    <button class="form-control btn btn-danger" type="button" ng-if="$ctrl.isRunning"
                            ng-click="$ctrl.killNginx()">Kill Nginx
                    </button>
                    <button class="form-control btn btn-info" type="button"
                            ng-click="$ctrl.showAccessLog()">Show Access-log
                    </button>
                    <hr>
                    <label> Logs :</label>
                    <pre><div ng-repeat="log in $ctrl.logs track by $index">{{log.date | date : 'dd/MM-HH:mm'}} : {{log.log}}</div>
                    </pre>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-6" ng-if="$ctrl.mode==='edit'">
            <edit-server id="$ctrl.editServer.$loki"
                         ng-if="$ctrl.editServer.$loki"
                         on-save="$ctrl.stopEdit()"
            ></edit-server>
        </div>
    </div>
</div>